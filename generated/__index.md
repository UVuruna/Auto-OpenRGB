# generated/

Auto-generated scripts for time-based RGB profile switching.

## Purpose

Contains scripts generated by [setup.ps1](../setup.md). These files use system time to determine which RGB profile to activate.

## Contents

| File | Description | Used For |
|------|-------------|----------|
| autoprofile.vbs | Daily profiles with retry logic | Task Scheduler (at logon) |
| autoprofile.bat | Daily profiles (no retry) | Manual use / debugging |
| autorainbow.bat | Rainbow profiles from `rainbow` | Keyboard shortcut |

## How It Works

### autoprofile.vbs (Task Scheduler)

1. Wait for OpenRGB server to be ready (max 60 sec)
2. Read current hour from system time
3. Determine profile based on hour ranges
4. Launch OpenRGB with the appropriate profile (hidden)

The retry logic checks every 2 seconds if `OpenRGB.exe` process exists. This ensures the profile is applied even if the script runs before the server starts.

### autoprofile.bat / autorainbow.bat

1. Read current hour from system time
2. Compare with calculated ranges for each profile
3. Launch the appropriate OpenRGB profile

Times are automatically calculated from `config.json`:
- `duration = 24 / number_of_profiles`
- `start = startHour + (duration * index)`
- `end = start + duration`

## Usage

### autoprofile.vbs
Runs automatically at logon and resume from sleep via Task Scheduler. No visible window.

### autoprofile.bat
For manual testing or debugging. Shows CMD window.

### autorainbow.bat
Can be run via:
- Double-click
- Keyboard shortcut (e.g., via AutoHotkey or Windows shortcut)

## Notes

- Files are NOT edited manually - edit `config.json` then run `setup.ps1`
- VBS files run hidden (no window)
- BAT files show CMD window
